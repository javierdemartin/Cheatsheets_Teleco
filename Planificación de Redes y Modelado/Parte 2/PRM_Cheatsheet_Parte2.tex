\documentclass[10pt,landscape]{article}
\usepackage{multicol}
\usepackage{calc}
\usepackage[landscape]{geometry}
\usepackage{amsmath,amsthm,amsfonts,amssymb}
\usepackage{color,graphicx,overpic}
\graphicspath{ {images/} }
\usepackage{hyperref}
\usepackage{tikz}
\usepackage{esint}
\usepackage{bm}
\usepackage{relsize}
\usepackage{datetime}
\usepackage[utf8] {inputenc}
\usepackage[spanish, activeacute] {babel}
\usepackage{IEEEtrantools}
\usepackage{framed}
\usetikzlibrary{arrows}

\usepackage{pgfplots}

\usepackage{pgf}
\usetikzlibrary{arrows,automata}

\usepackage{draftwatermark}
\SetWatermarkText{Javier de Martín}
\SetWatermarkScale{4.8}

% This sets page margins to .5 inch if using letter paper, and to 1cm
% if using A4 paper. (This probably isn't strictly necessary.)
% If using another size paper, use default 1cm margins.
\ifthenelse{\lengthtest { \paperwidth = 11in}}
    { \geometry{top=.5in,left=.5in,right=.5in,bottom=.5in} }
    {\ifthenelse{ \lengthtest{ \paperwidth = 297mm}}
        {\geometry{top=1cm,left=1cm,right=1cm,bottom=1cm} }
        {\geometry{top=1cm,left=1cm,right=1cm,bottom=1cm} }
    }

% Turn off header and footer
\pagestyle{empty}

% Redefine section commands to use less space
\makeatletter
\renewcommand{\section}{\@startsection{section}{1}{0mm}%
                                {-1ex plus -.5ex minus -.2ex}%
                                {0.5ex plus .2ex}%x
                                {\normalfont\large\bfseries}}
\renewcommand{\subsection}{\@startsection{subsection}{2}{0mm}%
                                {-1explus -.5ex minus -.2ex}%
                                {0.5ex plus .2ex}%
                                {\normalfont\normalsize\bfseries}}
\renewcommand{\subsubsection}{\@startsection{subsubsection}{3}{0mm}%
                                {-1ex plus -.5ex minus -.2ex}%
                                {1ex plus .2ex}%
                                {\normalfont\small\bfseries}}
\makeatother

\newcommand{\Lagr}{\mathcal{L}}

% Define BibTeX command
\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}

% Don't print section numbers
\setcounter{secnumdepth}{0}


\setlength{\parindent}{0pt}
\setlength{\parskip}{0pt plus 0.5ex}

%My Environments
\newtheorem{example}[section]{Example}
% ---------------------------------------------------------------

\begin{document}
\raggedright
\footnotesize
\begin{multicols}{3}


% multicol parameters
% These lengths are set only within the two main columns
%\setlength{\columnseprule}{0.25pt}
\setlength{\premulticols}{1pt}
\setlength{\postmulticols}{1pt}
\setlength{\multicolsep}{1pt}
\setlength{\columnsep}{2pt}

\begin{framed}
	\begin{center}
    	\Large{\underline{Planificación de Redes y Modelado}} \\
	Parte 2:  ''Modelado de Tráfico'' \\
    	\scriptsize{3º Ingeniería de Telecomunicaciones | UPV/EHU}\\
     	%Actualizado por Ãºltima vez el \today \\
     	"\textsl{Under-promise and over-deliver}." \\
     	%\hspace{5 pt} \\
     	\small{\textbf{Javier de Martín -- 2016/17}}
	\end{center}
\end{framed}

%
% Cheatsheet code below 
%                             

\section{Variables}

$\lambda$: Tasa de llegada de usuarios (nº usuarios llegados / tiempo) \\
	\quad $1 / \lambda$: Tiempo medio entre llegadas consecutivas\\
$\mu$: Tasa de servicio\\
	\quad $1 / \mu$: Tiempo medio de servicio\\
$C$: Capacidad del canal\\
$\rho = \frac{\lambda}{\mu}$: Factor de utilización (intensidad de tráfico)\\
$N$: Estado del sistema, número de clientes en el sistema\\

\section{\underline{Fundamentos de la Teoría de Colas}}

		\begin{center}
	\begin{tikzpicture}
		
		\draw[-to] (-1,-.5)--(0,-.5) node[midway, fill = white]{$\lambda$};
		\draw[thick] (0,0) -- (1.5,0) -- (1.5,-1) -- (0, -1);
		\draw (.75,-.5) node {Cola};
		\draw (1.5,-.5)--(2,-.5);
		\draw (2.4,-.5) circle (.4 cm);
		\draw (2.4,-.5) node {$\mu$};
		\draw[-to] (2.8,-.5)--(3.3,-.5);
	\end{tikzpicture}
\end{center}

Cuando $\lambda \rightarrow \mu$ la cola se hace inestable, para que sea \textbf{estable}: $\lambda < \mu$.\\
	
Si $\rho \rightarrow 1$ los tiempos de espera aumentan y la cola se llena rápidamente.

El \textbf{estado de la cola} es el número de usuarios/paquetes en la cola incluido el que pueda estar en el servidor.\\

Un \textbf{proceso de Poisson} es un caso particular del proceso de Markov en el cual la probabilidad de ocurrencia de un evento en $t + \Delta t$ es independiente de sucesos anteriores.

En una \textbf{distribución de Poisson} la probabilidad de $k$ llegadas es:

	\begin{equation*}
		p(k) = \frac{(\lambda \cdot T)^k}{k!} \cdot e^{- \lambda T} \hspace{10 pt} \rightarrow \hspace{10 pt}  \sum_{k=0}^{\infty} p(k) = 1
	\end{equation*}
	
La \textbf{esperanza} es $E(k)= \lambda \cdot T$ y \textbf{varianza} $\sigma^{2} (k) = \lambda \cdot T$.


\textbf{Tiempo entre eventos sucesivos}, función de densidad de probabilidad:

	\begin{equation*}
		f_{\tau} (\tau) = \lambda e^{- \lambda \tau}	 = \frac{\partial F_{\tau}(x)}{\partial x}
	\end{equation*}


\textbf{Relación de los procesos exponenciales con los poissonianos}, probabilidad de una llegada en un intervalo:

	\begin{equation*}
		Pr\{ \tau > x \} = p_{x}(0) = e^{-\lambda x}
	\end{equation*}
	
Función de distribución de probabilidad acumulativa, mide la probabilidad de que $\tau$ sea menor o igual a $x$:

	\begin{equation*}
		F_{\tau}(x) = 1 - e^{\lambda x}
	\end{equation*}
	
\textbf{Distribución del tiempo de servicio}:

	\begin{equation*}
	f_{r}(r) = \mu \cdot e^{- \mu r}
	\end{equation*}

\textbf{Propiedad}: Suponer $m$ procesos de Poisson independientes de tasas $\lambda_{1}$, $\lambda_{2}$, ..., $\lambda_{m}$ que se combinan, el proceso resultante será también de Poisson con una tasa $\lambda = \sum_{i = 1}^{m} \lambda_{i}$
	
\subsection{Notación Kendall}
	
	\begin{center}
		\large{A/B/m/K/c/z}
	\end{center}
	
	\begin{itemize}
		\item \textbf{A}: Distribución del tiempo entre llegadas
		\item \textbf{B}: Distribución del tiempo de servicio
		\item \textbf{m}: Número de servidores en paralelo en el sistema
		\item \textbf{K}: Capacidad de la cola (incluyendo servidores)
		\item \textbf{c}: Tamaño de la fuente
		\item \textbf{z}: Disciplina de la cola
	\end{itemize}

Las distribuciones de llegadas y servicio pueden ser:

	\begin{itemize}
		\item \textbf{M}: Exponencial
		\item \textbf{$E_{k}$}: Erlang de $k$ etapas
		\item \textbf{$H_{k}$}: Hiperexponencial de $k$ etapas
		\item \textbf{G}: General
		\item \textbf{D}: Determinística (constante)
	\end{itemize}
	
Por defecto para colas A/B/N la cola es infinita y la disciplina FIFO.

Cuando el sistema alcanza su estado más estable se supone que la probabilidad de usuarios en el mismo no varía con el tiempo. Con el tiempo los valores de $p_{n}$ se irán aproximando a los valores más estables.

\subsection{M/M/1}

Las \textbf{ecuaciones de balance} permiten calcular la probabilidad de estado $p_{n}$. En el diagrama de estados, el $\#$ es el número de clientes en el sistema. El factor de utilización es $\rho = \lambda / \mu$.

\begin{center}
\begin{tikzpicture}[node distance = 1.5cm]
  \tikzstyle{every state}=[fill=gray,draw=none,text=white]

  \node[state] (A)                    {$0$};
  \node[state]         (B) [right of=A] {$1$};
  \node[state]         (C) [right of=B] {$2$};
  \node[state]         (D) [right of=C] {$...$};
  
 	\path (A) edge [bend left]  node[above] {$\lambda$} (B)
  		(B) edge [bend left]  node[below] {$\mu$} (A);
	\path (B) edge [bend left]  node[above] {$\lambda$} (C)
  		(C) edge [bend left]  node[below] {$\mu$} (B);
	\path (C) edge [bend left]  node[above] {$\lambda$} (D)
  		(D) edge [bend left]  node[below] {$\mu$} (C);
	   
%            edge              node {1,1,R} (C)
%        (B) edge [loop above] node {1,1,L} (B)
%            edge              node {0,1,L} (C)
%        (C) edge              node {0,1,L} (D)
%            edge [bend left]  node {1,0,R} (E)
%        (D) edge [loop below] node {1,1,R} (D)
%            edge              node {0,1,R} (A)
%        (E) edge [bend left]  node {1,0,R} (A);
;

%\node[draw] at (3,-2) {$\rho = \frac{\lambda}{\mu}$};


\end{tikzpicture}
\end{center}

\begin{align*}
  \begin{cases}
      (n-1) & \rightarrow \text{Ha llegado un usuario} \\ 
      n & \rightarrow \text{No ha llegado ni salido nadie} \\
      (n+1) & \rightarrow \text{Ha salido un usuario}
    \end{cases}
\end{align*}

	
	\begin{IEEEeqnarray*}{rCl}
		\lambda \cdot p_{n} & = & \mu \cdot p_{n+1}  \hspace{10pt} n = 0,1,2... \hspace{10pt} \sum_{n=0}^{\infty} p_{n} = 1\\
			p_{n+1} & = & \rho \cdot p_{n}
	\end{IEEEeqnarray*}
	





Es condición necesaria que $\rho < 1$:

	\begin{equation*}
		p_{0} = \frac{1}{\sum_{n=0}^{\infty} p_{n} = 1} =(1 - \rho) \hspace{20 pt} p_{n} = (1-\rho) \cdot \rho^{n} \hspace{20 pt} \forall \rho = \frac{\lambda}{\mu}
	\end{equation*}
	


Es condición necesaria que $\rho < 1$:

	\begin{equation*}
		p_{0} = \frac{1 - \rho}{1 - \rho^{N+1}} \hspace{20 pt} p_{n} =\frac{1 - \rho}{1 - \rho^{N+1}} \cdot \rho^{n} \hspace{20 pt} \forall \rho = \frac{\lambda}{\mu}
	\end{equation*}

La \textbf{probabilidad de bloqueo} es $P_{N} = p_{n}$.

Tiempo medio por cliente en el sistema:

	\begin{equation*}
	\frac{1}{\mu ( 1 - \rho)}
	\end{equation*}
	
Tiempo medio de espera en cola:

	\begin{equation*}
	\frac{\rho}{\mu (1 - \rho)}
	\end{equation*}

\subsection{Cola M/M/N}

Permite procesamiento en paralelo al tener múltiples servidores, el factor de utilización es $\rho = \lambda / m \mu$.

La tasa media de llegada $\lambda$ es constante e independiente del estado del sistema ($\lambda_{n} = \lambda$).

\begin{tikzpicture}[node distance = 1.4cm]
\tikzstyle{every state}=[fill=gray,draw=none,text=white]

\node[state] (A) {$0$};
\node[state] (B) [right of=A] {$1$};
\node[state] (C) [right of=B] {$2$};
%\node[state] (D) [right of=C] {$...$};
\node[state] (E) [right of=C] {$N-2$};
\node[state] (F) [right of=E] {$N-1$};
\node[state] (G) [right of=F] {$N$};

\path (A) edge [bend left] node[above] {$\lambda$} (B)
(B) edge [bend left] node[below] {$\mu$} (A);
\path (B) edge [bend left] node[above] {$\lambda$} (C)
(C) edge [bend left] node[below] {$2\mu$} (B);
%\path (C) edge [bend left] node[above] {$\lambda$} (D)
%(D) edge [bend left] node[below] {$\mu$} (C);
%\path (D) edge [bend left] node {} (E)
%(E) edge [bend left] node {} (D);
\path (E) edge [bend left] node[above] {$\lambda$} (F)
(F) edge [bend left] node[below] {$\mu (N-1)$} (E);
\path (F) edge [bend left] node[above] {$\lambda$} (G)
(G) edge [bend left] node[below] {$\mu N$} (F);

% edge node {1,1,R} (C)
% (B) edge [loop above] node {1,1,L} (B)
% edge node {0,1,L} (C)
% (C) edge node {0,1,L} (D)
% edge [bend left] node {1,0,R} (E)
% (D) edge [loop below] node {1,1,R} (D)
% edge node {0,1,R} (A)
% (E) edge [bend left] node {1,0,R} (A);
;


%\node[draw] at (3,-2) {$\rho = \frac{\lambda}{N \mu}$};

\end{tikzpicture}

	\begin{IEEEeqnarray*}{rCl}
		p_{n} & =  &\frac{n+1}{N \rho} \cdot p_{n+1} \hspace{10pt} n = 0,..., N-1\\
      p_{n+1} & =  &\rho \cdot  p_{n} \hspace{38pt} n \geq N 
	\end{IEEEeqnarray*}



\subsection{Throughput ($\gamma$)}

	\begin{center}
	\begin{tikzpicture}
		\node [draw, align=center, fill={rgb:black,1;white,2}, text = white] at (0,0) {Sistema\\ de Colas};
%		\node [draw, align=center, fill={rgb:black,1;white,2}, text = white] at (0,-1) {$F_2$};	
	
%		\node [draw, align=center, fill={rgb:black,1;white,2}, text = white] at (2,0) {$P_1$};
%		\node [draw, align=center, fill={rgb:black,1;white,2}, text = white] at (2,-1) {$P_2$};
	
		\draw (-1.75,0.2) -- node[above left] {$\lambda$} (-0.646,0.2);
		\draw (-1.75,-0.2) -- node[above left] {$\lambda P_{B}$} (-0.646,-0.2);
		\draw (0.67,0) -- node[above left] {$\gamma$} (1.75,0);
		
%		\draw (0.25,-1) -- node[above left] {} (1.75,-1);
%		\draw [blue,  -to, thick] (0.5,0) -- (1.5,0) node [right] {};
%		\draw [red,  -to, thick] (0.5,0) .. controls (1.10,0) and (0.7,-1) .. (1.5,-1);
%		\draw [red,  -to, thick] (0.5,0) .. controls (1.05,0) and (0.88,-1) .. (0.5,-1);
	\end{tikzpicture}
\end{center}

	\begin{IEEEeqnarray*}{rCl}
		\gamma & = & \lambda \cdot (1 - P_{B}) \\
			     & = & \mu \cdot (1 - p_{0}		
	\end{IEEEeqnarray*}
	
Para una \textbf{cola infinita}:

	\begin{equation*}
		\gamma = \mu \cdot \rho = \lambda
	\end{equation*}
	
Para una \textbf{cola finita}:

	\begin{equation*}
		P_{B} = \frac{1 - \rho}{1 - \rho^{N+1}} \cdot \rho^{N} = P_{N}
	\end{equation*}
	
\subsection{Cola M/M/1/N en función de $\rho$}

Si el sistema está lleno, $N$, no se permite la entrada a nuevos clientes al sistema. La tasa de llegadas no es constante y varía con el tiempo en función de si el sistema está lleno o no:
	
	\begin{equation*}
	\lambda_{ef} = \lambda (1 - p_{k})
	\end{equation*}
	
	\begin{equation*}
	p_{n} = \rho^{n} \cdot p_{0}
	\end{equation*}
	
Para estos sistemas no existe el estado $k+1$.

	\begin{equation*}
		p_{n} = \frac{1 - \rho}{1 - \rho^{N+1}} \cdot \rho^{n}
	\end{equation*}
	
	\textbf{Región de congestión}
	
\subsection{Throughput Normalizado ($\gamma / \mu$)}

Mide la relación entre los usuarios que son atendidos en el sistema por unidad de tiempo y los que potencialmente podrían haber sido atendidos.

	\begin{equation*}
		\frac{\gamma}{\mu} = \frac{1 - \rho^{N}}{1 - \rho^{N+1}} \cdot \rho = \frac{Usuarios atendidos / seg}{Usuarios potenciales / seg}
	\end{equation*}
	
	\text{Insertar Gráfica}
	
\subsection{Número medio de usuarios en la cola M/M/1 E(n)}

	\begin{equation*}
		E(n) = \frac{\rho}{1 - \rho}
	\end{equation*}
	
\subsection{Tiempo Medio de Estancia en la Cola E(T)}
	
	\begin{equation*}
		E(T) = \frac{E(n)}{\gamma} \hspace{15pt} \rightarrow \hspace{15pt} E(T)_{M/M/1} =  \frac{1}{(1 - \rho) \cdot \mu} = \frac{1}{\mu - \lambda}
	\end{equation*}
	
\subsection{Tiempo Medio de Espera en la Cola E(w)}
	
	\begin{equation*}
		E(w) = E(T) - 1 / \mu
	\end{equation*}
	
\subsection{Número medio de usuarios esperando en la cola E(q)}
	
	\begin{equation*}
		E(q) = \gamma \cdot E(w)
	\end{equation*}

\subsection{Colas dependientes del estado: Proceso de nacimiento y muerte}

En las \textbf{colas dependientes del estado} las tasas de llegada $\lambda$ y las de servicio $\mu$ dependen del estado del sistema. Un \textbf{proceso de nacimiento} como un caso de procesos de Markov donde las tasas de llegada son función del estado. Un \textbf{proceso de muerte} es otro caso de procesos de Markov donde también las salidas son función del estado de la cola.


\subsection{Ecuaciones de Balance}

	\begin{equation*}
	p_{n} = \frac{\prod_{i = 0}^{n-1} \lambda_{i}}{\prod_{i = 1}^{n} \mu_{i}} \cdot p_{0}
	\end{equation*}

\textbf{Fórmulas de Pollaczek Khinchine} para distribuciones M/D/1:

Número medio de usuarios E(n):

	\begin{equation*}
	E(n) = \frac{\rho}{1 - \rho} \cdot \left( 1 - \frac{\rho}{2} \right)% (1 - \mu^{2} \sigma^{2} \right)
	\end{equation*}

Tiempo medio de estancia en la cola E(T):

	\begin{equation*}
	E(T) = \frac{E(n)}{\gamma} = \frac{1}{\mu (1 - \rho)} \cdot \left( 1 - \frac{\rho}{2} \right) %(1 - \mu^{2} \sigma^{2}) \right)
	\end{equation*}


\section{\underline{Modelado de Protocolos de N.Enlace}}

``\textit{Su función principal es el control del enlace de datos entre dos nodos adyacentes.}''\\

\subsection{Stop \& Wait}

Envía cada trama y espera recibir un ACK o NACK:

	\begin{itemize}
		\item Si llega un ACK se libera el buffer que almacenaba el paquete transmitido y se envía otra trama.
		\item Si llega un NACK o expira el temporizador, se retransmite la trama.
	\end{itemize}

\begin{center}
\begin{tikzpicture}[scale = .8]
%\draw[help lines, color=gray!30, dashed] (-4.9,-4.9) grid (4.9,4.9);
%\draw[ultra thick] (0,0)--(8,0) node[right]{$tiempo$};
\draw [-to, thick] (0,0) -- (8,0) node[right]{t};

\node [draw, align=center, fill={rgb:black,1;white,2}, text = white] at (1,.5) {Trama A1 \\ $t_{I}$};
\node [draw, align=center, fill={rgb:black,1;white,2}, text = white] at (6,.5) {Trama A1 ó A2 \\ $t_{I}$};

\draw[-to] (0,1.3)--(2,1.3) node[midway, fill = white]{$t_{I}$};
\draw[-to] (4.55,1.3)--(7.4,1.3) node[midway, fill = white]{$t_{I}$};

\draw[-to] (2,.5)--(4.55,.5) node[midway, fill = white]{$t_{out}$};
\draw[-to] (0,-.5)--(4.55,-.5) node[midway, fill = white]{$t_{T}$};

\end{tikzpicture}
\end{center}


	\begin{itemize}
		\item $t_{I}$: Tiempo requerido para transmitir una trama
		\item $t_{out}$: Tiempo del temporizador de espera de ACK\\
			\qquad $t_{out} \geq 2 \cdot t_{p} + t_{proc} + t_{s}$
			
			\begin{itemize}
				\item $t_{p}$: Tiempo de retardo de propagación
				\item $t_{proc}$: Tiempo de procesado en recepción
				\item $t_{s}$: Tiempo de transmisión de respuesta
			\end{itemize}
		\item $t_{T}$: Tiempo mínimo entre tramas de datos sucesivas \\
			\qquad $t_{T} = t_{I} + t_{out}$
	\end{itemize}

Apropiado para la transmisión semiduplex \footnote{Envío bidireccional pero no simultáneo}. No es apropiado para transmisión duplex si el tiempo de propagación es mucho mayor que el tiempo empleado para transmitir la trama.

Debido a retransmisiones provocadas por tramas erróneas:

	\begin{equation*}
	\gamma_{real} < \gamma_{max}
	\end{equation*}
	
Tiempo medio para una transmisión correcta:

	\begin{equation*}
	t_{v} = \frac{t_{T}}{1- p}
	\end{equation*}
	
Throughput máximo:
	
	\begin{IEEEeqnarray*}{rCl}
		TH_{max_{S\&W}}  = \lambda_{max_{S\&W}} = \frac{1}{t_{v}} & = & \frac{1 - p}{t_{T}}	\\
								   & = & \frac{1 - p}{a \cdot t_{I}} (paq / seg) \hspace{15 pt} a = \frac{t_{T}}{t_{I}} \geq 1
	\end{IEEEeqnarray*}
	
Throughput normalizado real $\rho$:

	\begin{equation*}
	\rho \equiv \lambda \cdot t_{I} \leq \lambda_{max} \cdot t_{I} = \frac{1 - p}{a} < 1
	\end{equation*}
	
\begin{center}
\begin{tabular}{|l|l|l|}

\hline
nº & Tiempo & Probabilidad \\ \hline
1  &    $t_{T} = t_{I} + t_{out}$    &        $1 - p$      \\ \hline
2  & $2 \cdot t_{T} $        &   $p(1 - p)$          \\ \hline
...   &    ...    &     ...        \\ \hline
n  &    $n \cdot t_{T}$    &      $p^{n-1} (1-p) $       \\ \hline
\end{tabular}
\end{center}

\subsection{Go-Back-N}

	\begin{center}
	\begin{tikzpicture}[scale = .8]
%\draw[help lines, color=gray!30, dashed] (-4.9,-4.9) grid (4.9,4.9);
%\draw[thick] (0,0)--(8,0) node[right]{$tiempo$};
\draw [-to, thick] (0,0) -- (10,0) node[right]{t};

\node [draw, align=center, fill={rgb:black,1;white,2}, text = white] at (1,.28) {A1};
\node [draw, align=center, fill={rgb:black,1;white,2}, text = white] at (3,.28) {A2};
\node [draw, align=center, fill={rgb:black,1;white,2}, text = white] at (5,.28) {A3};
\node [draw, align=center, fill={rgb:black,1;white,2}, text = white] at (7,.28) {A1};
%
%\draw[] (1.75,.5)--(3,.5);
%\draw[] (3.5,.5)--(6,.5) node[above]{$t_{out}$};
%\draw[] (3.5,.5)--(6,.5);

\draw[-to] (0,1)--(1.9,1) node[midway, fill = white]{$t_{I}$};
\draw[-to] (2,1)--(3.9,1) node[midway, fill = white]{$t_{I}$};
\draw[-to] (4,1)--(5.9,1) node[midway, fill = white]{$t_{I}$};
\draw[-to] (6,1)--(7.9,1) node[midway, fill = white]{$t_{I}$};

\draw[-to] (2,1.5)--(5.9,1.5) node[midway, fill = white]{$t_{out}$};
\draw[-to] (0,-.5)--(5.9,-.5) node[midway, fill = white]{$t_{T}$};

\end{tikzpicture}

\textit{Transmisión con errores}

	\end{center}
	
	
\begin{center}
\begin{tabular}{|l|l|l|}

\hline
nº & Tiempo & Probabilidad \\ \hline
1  &    $t_{I}$    &        $1 - p$      \\ \hline
2  & $t_{I} + t_{T} $        &   $p(1 - p)$          \\ \hline
...   &    ...    &     ...        \\ \hline
n  &    $t_{I} + (n - 1) \cdot t_{T}$    &      $p^{n-1} (1-p) $       \\ \hline
\end{tabular}
\end{center}
	
	\begin{equation*}
	t_{v} = t_{I} \frac{1 + (a - 1) p}{1 - p} \hspace{15pt} a \equiv \frac{t_{T}}{t_{I}} = \frac{t_{I} + t_{out}}{t_{I}} = 1 + \frac{t_{out}}{t_{I}}
	\end{equation*}

Throughput máximo:

	\begin{equation*}
	\lambda_{max} = \frac{1}{t_{v}} = \frac{1 - p}{t_{I} \cdot (1 + (a - 1) p)}
	\end{equation*}
	
Throughput normalizado:

	\begin{equation*}
	\rho = \lambda \cdot t_{I} \leq \frac{1 - p}{1 + (a-1) p} < 1
	\end{equation*}

	\begin{equation*}
	\lambda_{max_{GBN}} = a \cdot \lambda_{max_{S\&W}}
	\end{equation*}

\textbf{ACKs embebidos en tramas B-A}

\text{Influencia de la tasa de error}

\begin{center}
\begin{tikzpicture}[scale = .8]
%\draw[help lines, color=gray!30, dashed] (-4.9,-4.9) grid (4.9,4.9);
%\draw[ultra thick] (0,0)--(8,0) node[right]{$tiempo$};
\draw [-to, thick] (0,0) -- (8,0) node[right]{t};

\node [draw, align=center, fill={rgb:black,1;white,2}, text = white] at (1,.5) {Trama A1 \\ $t_{I}$};
\node [draw, align=center, fill={rgb:black,1;white,2}, text = white] at (6,.5) {Trama A1 ó A2 \\ $t_{I}$};

\draw[-to] (0,1.3)--(2,1.3) node[midway, fill = white]{$t_{I}$};
\draw[-to] (4.55,1.3)--(7.4,1.3) node[midway, fill = white]{$t_{I}$};

\draw[-to] (2,.5)--(4.55,.5) node[midway, fill = white]{$t_{out}$};
\draw[-to] (0,-.5)--(4.55,-.5) node[midway, fill = white]{$t_{T}$};

\end{tikzpicture}
\end{center}

	\begin{center}
		\begin{tikzpicture}[scale = 0.6]
			\fill[gray!40!white] (0,0) rectangle (2,1);
			\draw[white] (1,.5) node{Control};
			\fill[gray!40!black] (2.05,0) rectangle (5,1);
			\draw[white] (3.5,.5) node{Información};
			
			\draw[-to] (0,1.4)--(2,1.4) node[midway, fill = white]{$l^{'}$};
			\draw[-to] (2.05,1.4)--(5,1.4) node[midway, fill = white]{$l$};
		\end{tikzpicture}
	\end{center}
	
\textbf{Erorres en enlaces de satélite}, como \textbf{hipótesis} se toma que $p_{b}$ es la probabilidad de error de bit independiente de la posición del bit debido al ruido aleatorio. Probabilidad de error de trama $p$: $p = 1 - (1 - p_{b})^{l + l^{'}} = 1 - q_{b}^{l + l^{'}} $. Si $p_{b} << 1 \rightarrow p \approx (l + l^{'}) p_{b} \rightarrow p << 1$.

\textbf{Errores en enlaces terrestres}, los errores se producen en ráfagas. $p$ es proporcional a $l + l^{'}$, si $p_{b} << 1 \rightarrow p \approx (l + l^{'}) k$.\\

\textbf{Tasa de datos normalizada D/C}, la estación emisora está en saturación ($\lambda_{max}$) y se utiliza el protocolo tipo Go-Back-N.

	\begin{IEEEeqnarray*}{rCl}
		D & = & \lambda_{max} \cdot l = l \cdot \frac{1 - p}{ t_{I} \cdot (1 + (a-1)) p} \hspace {20pt} t_{I} = \frac{l + l^{'}}{C} \\
		C & \equiv & Capacidad del canal\\
		\frac{D}{C} & = & \frac{l}{l + l^{'}} \cdot  \frac{1 - p}{ t_{I} \cdot (1 + (a-1)) p} \leq 1
	\end{IEEEeqnarray*}	


\textbf{Cálculo de la longitud óptima}

\textbf{Hipótesis}: $a = 1$ (Stop \& Wait) o $(a-1) \cdot p \ll 1$.\\

Caso general de \textbf{satélite}:

	\begin{IEEEeqnarray*}{rCl}
	l_{opt} & = & \frac{l^{'}}{2} \cdot \left( \sqrt{1 - \frac{4}{l^{'} \cdot L_{n} q_{b}}} - 1 \right) \\
	           & \approx & \sqrt{\frac{l^{'}}{p_{b}}} \hspace{10pt} \text{suponiendo } p_{b} \ll 1 \rightarrow p_{b} \cdot l^{'} \ll 1
	\end{IEEEeqnarray*}	

Caso \textbf{terrestre/satélite} simplificado $p = p_{b} (l + l^{'})$:

	\begin{equation*}
		l_{opt} = \approx \sqrt{\frac{l^{'}}{p_{b}}} 
	\end{equation*}
	
\subsection{Protocolo HDLC}

	\begin{center}
		\begin{tikzpicture}[scale = 0.6]
			\fill[gray!40!white] (0,0) rectangle (1,1);
			\draw[white] (.5,.5) node{A};
			
			\draw[-to] (.5,0) |- (1.5,-4) node[right] {Direcciones};
			
			\fill[gray!40!white] (1.05,0) rectangle (2.05,1);
			\draw[white] (1.5,.5) node{C};
			
			\draw[-to] (1.5,0) |- (2,-1.7) node[right] {Información:};
			
			\fill[gray!40!white] (5,-2.2) rectangle (6,-1.2);
			\draw[white] (5.5,-1.7) node{0};
			\fill[gray!40!white] (6.05,-2.2) rectangle (7.5,-1.2);
			\draw[white] (6.8,-1.7) node{N(S)};
			\fill[gray!40!white] (7.55,-2.2) rectangle (9.05,-1.2);
			\draw[white] (8.3,-1.7) node{P/F};
			\fill[gray!40!white] (9.1,-2.2) rectangle (10.5,-1.2);
			\draw[white] (9.8,-1.7) node{N(R)};
			
			\draw[-to] (1.5,0) |- (2,-2.8) node[right] {Supervisión:};
			
			\fill[gray!40!white] (5,-3.3) rectangle (6,-2.3);
			\draw[white] (5.5,-2.8) node{1 0};
			\fill[gray!40!white] (6.05,-3.3) rectangle (7.5,-2.3);
			\draw[white] (6.8,-2.8) node{SS};
			\fill[gray!40!white] (7.55,-3.3) rectangle (9.05,-2.3);
			\draw[white] (8.3,-2.8) node{P/F};
			\fill[gray!40!white] (9.1,-3.3) rectangle (10.5,-2.3);
			\draw[white] (9.8,-2.8) node{N(R)};
			
			\fill[gray!40!white] (2.1,0) rectangle (5.1,1);
			\draw[white] (3.6,.5) node{Información};
			\fill[gray!40!white] (5.15,0) rectangle (7.15,1);
			\draw[white] (6.2,.5) node{CRC};
			
			\draw[-to] (6.2,0) |- (7,-.5) node[right] {Control de Errores};
			
		\end{tikzpicture}
	\end{center}

SS $\rightarrow$ tipos de tramas de supervisión:

	\begin{itemize}
		\item RR (\textit{Ready to Receive}): Confirma las tramas hasta $N(R) - 1$.
		\item RNR (\textit{Not Ready to Receive}): Confirma las tramas hasta $N(R) - 1$ y establece control de flujo con condición de bloqueo.
		\item REJ (\textit{Reject}): Confirma las tramas hasta $N(R) - 1$ y retransmisión desde la trama $N(R)$.
		\item SREJ (\textit{Selective Reject}): Pide retransmisión de la trama $N(R)$.
	\end{itemize}
	
\textbf{Análisis en HDLC/ABM}:

	\begin{itemize}
		\item Se \textbf{diferencia respecto a Go-Back-N} de que tiene numeración de secuencia finita y procedimiento de control de errores específico.
		\item \textbf{Procedimiento de control de errores}, se define una implementación específica sobre la cual se realiza el análisis del protocolo:
			\begin{itemize}
				\item Recuperación vía REJ siempre que se pueda acelerar el procedimiento de recuperación. Sólo una vez por la misma trama.
				\item Recuperación por temporizador (además de REJ) para las retransmisiones sucesivas y errores no detectados por REJ.
				\item Envío de tramas P/F para obligar a respuestas forzadas en situaciones especiales de recuperación.
			\end{itemize}
	\end{itemize}
	
\textbf{Hipótesis} para el análisis:

	\begin{itemize}
		\item Sólo se transmite en el sentido $A \rightarrow B$.
		\item $A$ transmite en el régimen de saturación.
		\item $B$ responde con $RR$ ($ACK$) y $REJ$ ($NACK$).
	\end{itemize}
	
\textbf{Datos} para el análisis:

\textbf{Módulo}: Número de tramas con diferente numeración que pueden ser enviadas.\\
\textbf{Ventana}: Número máximo de tramas que pueden estar en circulación sin haber sido confirmadas.\\
\textbf{Longitud de tramas}: Información ($t_{I}$) y de supervisión ($t_{S}$):
	\begin{equation*}
		t_{I} = \frac{l + l^{'}}{C} \hspace{15 pt} t_{S} = \frac{l^{'}}{C}
	\end{equation*}
\textbf{Retardo de propagación} (incluyendo $t_{proc}$): $t_{p}$\\
\textbf{Tiempo de confirmación}: $t_{ack} = 2 \cdot t_{p} + t_{s}$\\
\textbf{Temporizador de reenvío}: $t_{out} = 2 \cdot t_{p} + 2 \cdot t_{I} > t_{ack}$\\	
	
Cuando ocurre un error se puede recuperar por REJ (primer caso) o TEMPORIZACIÓN (en todos los casos).
	
Throughput máximo:

	\begin{equation*}
	\lambda_{max} = \frac{1}{t_{v}} = \frac{1 - p}{t_{I} (1 + (a - 1)p)}
	\end{equation*}

$p$: Probabilidad de recibir una trama con error\\
$T_{1}$: Tiempo aleatorio requerido para la primera retransmisión (puede tomar diferentes valores)\\
$T_{2}$: Tiempo medio requerido para retransmisiones posteriores (es siempre igual en cada transmisión)\\
$t_{v}$: Tiempo medio de transmisión virtual de una trama de longitud $t_{I}$.


Tiempo medio de transmisión correcta de una trama:

	\begin{IEEEeqnarray*}{rCl}
		t_{V} & = & t_{I} + E[T_{1}] p + \frac{T_{2} p^{2}}{1-p}
	\end{IEEEeqnarray*}	


\textbf{TERMINAR}


\section{\underline{Modelado de N.Red y Control de Flujo}}

\begin{center}
\begin{tikzpicture}[node distance = 2cm, auto]
\tikzstyle{every state}=[fill=gray,draw=none,text=white, scale = 0.6]

\node [draw, align=center, fill={rgb:black,1;white,2}, text = white] at (-1.5,0) {A};
\node [draw, align=center, fill={rgb:black,1;white,2}, text = white] at (5,0) {B};

\draw (1,.5)--(2.5,.5) node[midway, fill = white]{\scriptsize{CFL}};
\draw (-1.5,.5)--(0,.5) node[midway, fill = white]{\scriptsize{CFAR}};
\draw (0,-2)--(4,-2) node[midway, fill = white]{\scriptsize{CFNO/ND}};
\draw (-1.5,-3)--(5,-3) node[midway, fill = white]{\scriptsize{CFEE}};

\node[state] (A) {};
\node[state] (B) [right of=A] {};
\node[state] (C) [right of=B] {};
\node[state] (D) [right of=C] {};
\node[state] (F) [above of=B] {};
\node[state] (G) [right of=F] {};
\node[state] (H) [below of=B] {};
\node[state] (I) [right of=H] {};

\draw (A) -- (B)
	 (B) -- (C)
	 (C) -- (D)
	 (D) -- (G)
	 (F) -- (G)
	 (A) -- (F)
	 (A) -- (H)
	 (H) -- (I)
	 (I) -- (D)
	 (-1.14,0) -- (A)
	 (4.66,0) -- (D)
	 ;
\end{tikzpicture}
\end{center}

\textbf{CFL}: Control de Flujo Local\\
\textbf{CFEE}: Control de Flujo Entre Extremos\\
\textbf{CFNO/ND}: Control de Flujo entre Nodos Origen y Destino\\


\newpage

\section{\underline{Demostraciones}}

\subsection{Esperanza y varianza en eventos Poissonianos}

	\begin{IEEEeqnarray*}{rCl}
		E(k) & = & \sum_{k=0}^{\infty} k \cdot p(k) = \sum_{k = 0}^{\infty} k \cdot \frac{{(\lambda \cdot T)}^{k}}{k!} \cdot e^{- \lambda T} = \\
			& = &   e^{- \lambda T} \cdot \left( \sum_{k = 1}^{\infty} \lambda T \cdot \frac{ k \cdot{(\lambda \cdot T})^{k-1}}{k \cdot (k-1)!} \right) = e^{- \lambda T} \cdot \lambda \cdot T \cdot e^{\lambda T} = \\
			& = & \lambda \cdot T
	\end{IEEEeqnarray*}	
	
	\begin{IEEEeqnarray*}{rCl}
		\sigma^{2}_{k} & = & E \left[ (k - E[k])^{2} \right] = E[k^{2}] - E^{2}[k] = \sum_{k = 0}^{\infty} k^{2} \cdot p(k) - (\lambda \cdot T)^{2} = \\
				       & = & \sum_{k = 0}^{\infty} k^{2} \cdot \frac{{(\lambda \cdot T)}^{k}}{k!} e^{-\lambda T} - \lambda^{2} T^{2} = \\
				       & = & e^{- \lambda T} \cdot \left( \sum_{k = 1}^{\infty} \lambda T \cdot \frac{ k \cdot{(\lambda \cdot T})^{k-1}}{k \cdot (k-1)!} \right) - \lambda^{2} T^{2} = \\
				       & = & \lambda T e^{- \lambda T} \cdot \left( \sum_{k = 1}^{\infty} \frac{ (k-1+1) \cdot{(\lambda \cdot T})^{k-1}}{(k-1)!} \right) - \lambda^{2} T^{2} = \\
				       & = & \lambda T e^{- \lambda T} \cdot \left( \sum_{k = 1}^{\infty}  \frac{ (k-1) \cdot{(\lambda \cdot T})^{k-1}}{(k-1)(k-2)!} + \sum_{k=1}^{\infty} \frac{(\lambda T)^{k-1}}{(k-1)!} \right) - \lambda^{2} T^{2} = \\
				       & = & \lambda T e^{- \lambda T} \cdot \left( \lambda T \cdot  \sum_{k = 1}^{\infty} \frac{{(\lambda \cdot T})^{k-2}}{(k-2)!} + e^{\lambda T}\right) - \lambda^{2} T^{2} =\\
				       & = & \lambda T e^{-\lambda T} (\lambda T e^{ \lambda T} + e^{\lambda T}) - \lambda^{2} T^{2} =\\
				       & = & \lambda \cdot T
	\end{IEEEeqnarray*}	
	
\subsection{Demostración de la distribución de Poisson}

\subsection{Stop \& Wait Tiempo medio para una transmisión correcta}

	\begin{IEEEeqnarray*}{rCl}
		t_{v} & = & t_{T} (1-p) + 2 t_{T} (1-p) p + 3 t_{T} (1-p) p^{2} + ... = \\
		        & = & t_{T} (1-p) \sum_{i=1}^{\infty} i \cdot p^{i-1} = t_{T} (1-p) \frac{1}{(1-p)^{2}} = \\
		        & = & \frac{t_{T}}{1-p}
	\end{IEEEeqnarray*}	

\subsection{Go Back N Tiempo medio para  una transmisión correcta}

\begin{IEEEeqnarray*}{rCl}
		t_{V} & = & (1-p) \cdot t_{I} + (1-p) \cdot p (t_{T} + t_{I}) + (1-p) \cdot p^{2} (2 t_{T} + \cdot t_{I}) + ... = \\
			 & = & (1-p) \cdot t_{I} + (1-p) t_{T} \sum_{i=1}^{\infty} i \cdot p^{i} + (1-p) \cdot t_{I} \sum_{i = 1}^{\infty} p^{i} = \\
			 & = & (1-p) \cdot t_{I} + a \cdot t_{I} \cdot (1 - p) \frac{p}{(1-p)^{2}} + t_{I} \cdot (1-p) \cdot \frac{p}{1-p} = \\
			 & = & t_{I} ( 1 - p + \frac{a p}{1 - p} + p)  = t_{I} \frac{1 - p + ap}{1 - p} = \\
			 & = & t_{I} \frac{1 + (a - 1) p}{1 - p}
	\end{IEEEeqnarray*}


\end{multicols}
\end{document}